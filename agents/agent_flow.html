<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post-Parent Support Agent Architecture</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
    </script>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #1E3A5F;
        }

        .description {
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .agent-card {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .watchdog {
            background-color: #fff0f0;
            border-left: 5px solid #dc3545;
        }

        .input-agent {
            background-color: #f0f8ff;
            border-left: 5px solid #0d6efd;
        }

        .support-agent {
            background-color: #f0fff4;
            border-left: 5px solid #198754;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Post-Parent Support Agent Team</h1>

        <div class="description">
            <p>ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€å˜ä¸€ã®AIã§ã¯ãªãã€å°‚é–€å½¹å‰²ã‚’æŒã£ãŸ3ã¤ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒãƒãƒ¼ãƒ ã¨ã—ã¦é€£æºã—ã¦å‹•ä½œã—ã¾ã™ã€‚</p>
        </div>

        <div class="mermaid">
            flowchart TD
            User(["ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼ (æ”¯æ´è€…)"]) -->|è‡ªç„¶è¨€èªå…¥åŠ›| Main["Orchestrator (main.py)"]

            subgraph AgentTeam [Agent Team]
            Main -->|1. Check| Watchdog["ğŸ• EmergencyWatchdog"]

            Watchdog -- "ğŸš¨ SOSæ¤œçŸ¥ (Yes)" --> Emergency["âš¡ Fast Path Protocol"]
            Emergency -->|å³æ™‚å¯¾å¿œ| Alert["LINEé€šçŸ¥ / æ•‘æ€¥æƒ…å ±è¡¨ç¤º"]

            Watchdog -- "å®‰å…¨ (No)" --> Input["ğŸ“ InputAgent"]

            Input -->|2. æŠ½å‡º & æ§‹é€ åŒ–| Parsing["Gemini 2.0 Flash"]
            Parsing -->|JSONãƒ‡ãƒ¼ã‚¿| Support["ğŸ§  SupportAgent"]

            subgraph KnowledgeBase [Knowledge Base]
            Neo4j[("Neo4j Graph DB")]
            end

            Support <-->|3. å‚ç…§ & æ¨è«–| Neo4j
                Support -->|4. ææ¡ˆ + æ ¹æ‹ | Action["Care Plan / Log (with Reasoning Log)"]
                end

                Support -.->|æƒ…å ±ä¸è¶³: é€†è³ªå•| User

                Alert --> User
                Action --> User

                style Watchdog fill:#ffe6e6,stroke:#d63384,stroke-width:2px
                style Input fill:#e6f3ff,stroke:#0d6efd,stroke-width:2px
                style Support fill:#e6fffa,stroke:#00b894,stroke-width:2px
                style Neo4j fill:#fff3cd,stroke:#ffc107,stroke-width:2px
        </div>

        <div class="description">
            <h3>ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å½¹å‰²åˆ†æ‹…</h3>

            <div class="agent-card watchdog">
                <strong>ğŸ• EmergencyWatchdog (ç•ªçŠ¬)</strong>
                <p>å…¨ã¦ã®å…¥åŠ›ã®æœ€åˆã«ã€Œç·Šæ€¥æ€§ã€ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚SOSã‚„ãƒ‘ãƒ‹ãƒƒã‚¯ç­‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ¤œçŸ¥ã™ã‚‹ã¨ã€è¤‡é›‘ãªæ¨è«–ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦å³åº§ã«å‘½ã‚’å®ˆã‚‹è¡Œå‹•ï¼ˆFast Pathï¼‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã™ã€‚</p>
            </div>

            <div class="agent-card input-agent">
                <strong>ğŸ“ InputAgent (æ›¸è¨˜ãƒ»å—ä»˜)</strong>
                <p>æ›–æ˜§ãªç‰©èªèª¿ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿è§£ãã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç™»éŒ²ã§ãã‚‹å½¢ï¼ˆJSONï¼‰ã«æ•´ç†æ•´é “ã—ã¾ã™ã€‚åŒæ™‚ã«ã€Œç¦å¿Œäº‹é …ï¼ˆã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨ï¼‰ã€ã«è§¦ã‚Œã¦ã„ãªã„ã‹ã®å®‰å…¨ãƒã‚§ãƒƒã‚¯ã‚‚è¡Œã„ã¾ã™ã€‚</p>
            </div>

            <div class="agent-card support-agent">
                <strong>ğŸ§  SupportAgent (å‚è¬€ãƒ»ã‚±ã‚¢ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼)</strong>
                <p>æ•´ç†ã•ã‚ŒãŸæƒ…å ±ã¨ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚ã‚‹éå»ã®è¨˜æ†¶ï¼ˆç”Ÿè‚²æ­´ã€æˆåŠŸä½“é¨“ã€é¡˜ã„ï¼‰ã‚’çªãåˆã‚ã›ã¾ã™ã€‚ã€Œè¦ªãªã‚‰ã©ã†ã™ã‚‹ã‹ï¼Ÿã€ã¨ã„ã†è¦–ç‚¹ã§ã€æœ€é©ãªã‚±ã‚¢ãƒ—ãƒ©ãƒ³ã‚’ææ¡ˆã—ãŸã‚Šã€è¨˜éŒ²ã‚’çŸ¥è­˜ã¨ã—ã¦è“„ç©ã—ã¾ã™ã€‚</p>
                <ul>
                    <li><strong>æ¨è«–ãƒ­ã‚° (Reasoning Log):</strong> ã€Œãªãœãã®ææ¡ˆã‚’ã—ãŸã®ã‹ï¼Ÿã€ã®æ ¹æ‹ ï¼ˆå¥½ã¿ã‚„ç¦å¿Œï¼‰ã‚’æ˜ç¤ºã—ã€ä¿¡é ¼æ€§ã‚’é«˜ã‚ã¾ã™ã€‚</li>
                    <li><strong>å¯¾è©±ãƒ«ãƒ¼ãƒ— (Dialogue Loop):</strong> æƒ…å ±ä¸è¶³æ™‚ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€†è³ªå•ï¼ˆå·®ã—æˆ»ã—ï¼‰ã‚’è¡Œã„ã€ç²¾åº¦ã‚’é«˜ã‚ã¾ã™ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

</body>

</html>